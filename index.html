<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <base target="_top">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>2025 ç¦ç››åœ’è—è–èª•ç¯€è«¾è²æ¾é è³¼</title>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    /* ğŸŒ² è–èª•è«¾è²æ¾ä¸»é¡Œé¡è‰²è®Šæ•¸ */
    :root {
      --christmas-green: #154734;   /* è–èª•ä¸»ç¶  (æ·±æ¾ç¶ ) */
      --accent-red: #A80E2F;        /* ç¯€æ…¶é»ç¶´ç´… */
      --pine-shadow: #082119;       /* æ¾è‘‰é™°å½±æ·±ç¶  */
      --snow-white: #F8F8F8;        /* é›ªç™½èƒŒæ™¯/å¡ç‰‡è‰² */
      --accent-gold: #D4AF37;       /* è£é£¾é‡‘ */

      /* åŸºæœ¬è‰²å½© */
      --text-dark: #1C1C1C;         /* ä¸»è¦æ·±è‰²æ–‡å­— */
      --text-light: #6B7280;        /* æ¬¡è¦æ·ºè‰²æ–‡å­— */
      --border-color: #E5E7EB;      /* ä¸€èˆ¬é‚Šæ¡† */

      /* æ•ˆæœ */
      --shadow: 0 5px 15px rgba(21, 71, 52, 0.2); /* å¸¶æœ‰ç¶ è‰²çš„é™°å½±ï¼Œæ›´æœ‰è³ªæ„Ÿ */
      --shadow-hover: 0 10px 25px rgba(21, 71, 52, 0.3);
      --christmas-gradient: linear-gradient(135deg, var(--christmas-green) 0%, var(--accent-red) 100%);
    }

    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      line-height: 1.6;
      color: var(--text-dark);
      /* èª¿æ•´ç‚ºæ›´æŸ”å’Œçš„é›ªåœ°èƒŒæ™¯ */
      background: linear-gradient(135deg, #f0f8f0 0%, #ffffff 100%); 
      min-height: 100vh;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 20px;
    }

    /* Header */
    .header {
      /* ä½¿ç”¨è–èª•æ¼¸å±¤ */
      background: var(--christmas-gradient); 
      color: white;
      padding: 60px 0;
      text-align: center;
      position: relative;
      overflow: hidden;
    }

    .header::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      /* é›ªèŠ±æˆ–å¾®å…‰é»åœ–æ¡ˆ */
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="stars" x="0" y="0" width="20" height="20" patternUnits="userSpaceOnUse"><circle cx="10" cy="10" r="2" fill="rgba(255,255,255,0.15)"/></pattern></defs><rect width="100" height="100" fill="url(%23stars)"/></svg>');
      opacity: 0.4;
    }

    .header-content {
      position: relative;
      z-index: 1;
    }

    .header h1 {
      font-size: 2.5rem;
      font-weight: 700;
      margin-bottom: 10px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    .header .subtitle {
      font-size: 1.2rem;
      opacity: 0.9;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    /* Sections */
    .section {
      background: white;
      margin: 30px 0;
      padding: 40px;
      border-radius: 20px;
      box-shadow: var(--shadow);
      transition: all 0.3s ease;
      /* ä½¿ç”¨æ·ºç¶ è‰²ç³»é‚Šæ¡† */
      border: 1px solid rgba(21, 71, 52, 0.1); 
    }

    .section:hover {
      box-shadow: var(--shadow-hover);
      transform: translateY(-5px);
    }

    .section h2 {
      /* æ¨™é¡Œé¡è‰²ä½¿ç”¨ä¸»ç¶ è‰² */
      color: var(--christmas-green); 
      font-size: 1.8rem;
      margin-bottom: 25px;
      display: flex;
      align-items: center;
      gap: 15px;
      font-weight: 600;
    }

    .section h2::before {
      content: '';
      width: 4px;
      height: 30px;
      /* æ¨™é¡Œè£é£¾ä½¿ç”¨æ¼¸å±¤ */
      background: var(--christmas-gradient); 
      border-radius: 2px;
    }

    /* Info Cards */
    .info-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 20px;
    }

    .info-card {
      /* å¡ç‰‡èƒŒæ™¯ä½¿ç”¨é›ªç™½ */
      background: var(--snow-white); 
      padding: 25px;
      border-radius: 15px;
      /* é‚Šæ¡†ä½¿ç”¨é»ç¶´ç´… */
      border-left: 5px solid var(--accent-red); 
      transition: all 0.3s ease;
    }

    .info-card:hover {
      transform: translateX(10px);
      /* é™°å½±ä½¿ç”¨é»ç¶´ç´… */
      box-shadow: 0 5px 15px rgba(168, 14, 47, 0.2); 
    }

    .info-card h3 {
      /* æ¨™é¡Œä½¿ç”¨æ·±ç¶ è‰² */
      color: var(--pine-shadow); 
      margin-bottom: 15px;
      font-size: 1.1rem;
      font-weight: 600;
    }

    .info-card ul {
      list-style: none;
      padding-left: 0;
    }

    .info-card li {
      padding: 8px 0;
      padding-left: 25px;
      position: relative;
    }

    .info-card li::before {
      /* é …ç›®ç¬¦è™Ÿä½¿ç”¨è–èª•æ¨¹åœ–æ¡ˆ */
      content: 'ğŸ„'; 
      position: absolute;
      left: 0;
      top: 8px;
    }
    
    /* æ–°å¢æ¨£å¼ï¼šç²—é«”æ·±ç´…å­— */
    .accent-text {
      color: var(--accent-red); /* ä½¿ç”¨å®šç¾©çš„ç¯€æ…¶é»ç¶´ç´… */
      font-weight: bold;
    }

    /* Form Elements */
    .form-group {
      margin-bottom: 25px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--text-dark);
      font-size: 1rem;
    }

    .form-input {
      width: 100%;
      padding: 15px 20px;
      border: 2px solid var(--border-color);
      border-radius: 12px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background: white;
    }

    .form-input:focus {
      outline: none;
      /* èšç„¦é‚Šæ¡†ä½¿ç”¨ä¸»ç¶ è‰² */
      border-color: var(--christmas-green); 
      box-shadow: 0 0 0 3px rgba(21, 71, 52, 0.1);
      transform: translateY(-2px);
    }

    /* Radio and Checkbox */
    .radio-group, .checkbox-group {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-top: 15px;
    }

    .radio-item, .checkbox-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 15px 20px;
      background: white;
      border: 2px solid var(--border-color);
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      position: relative;
    }

    .radio-item:hover, .checkbox-item:hover {
      /* Hover æ•ˆæœä½¿ç”¨ä¸»ç¶ è‰²å’Œé›ªç™½èƒŒæ™¯ */
      border-color: var(--christmas-green); 
      background: var(--snow-white); 
      transform: translateX(5px);
    }

    .radio-item input[type="radio"], .checkbox-item input[type="checkbox"] {
      width: 18px;
      height: 18px;
      /* é¸ä¸­é¡è‰²ä½¿ç”¨ä¸»ç¶ è‰² */
      accent-color: var(--christmas-green); 
    }

    .radio-item.checked, .checkbox-item.checked {
      /* é¸ä¸­ç‹€æ…‹ä½¿ç”¨ä¸»ç¶ è‰²å’Œé›ªç™½èƒŒæ™¯ */
      border-color: var(--christmas-green); 
      background: var(--snow-white); 
    }

    /* Product Items */
    .product-list {
      display: grid;
      gap: 15px;
      margin-top: 20px;
    }

    .product-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background: white;
      border: 2px solid var(--border-color);
      border-radius: 15px;
      transition: all 0.3s ease;
    }

    .product-item:hover {
      /* Hover æ•ˆæœä½¿ç”¨ä¸»ç¶ è‰² */
      border-color: var(--christmas-green); 
      box-shadow: 0 5px 15px rgba(21, 71, 52, 0.1);
      transform: translateY(-2px);
    }

    .product-name {
      font-weight: 600;
      color: var(--text-dark);
      flex: 1;
    }

    .product-quantity {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .quantity-btn {
      width: 40px;
      height: 40px;
      /* æŒ‰éˆ•ä½¿ç”¨é»ç¶´ç´… */
      border: 2px solid var(--accent-red); 
      background: white;
      color: var(--accent-red);
      border-radius: 50%;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    .quantity-btn:hover {
      /* Hover èƒŒæ™¯ä½¿ç”¨é»ç¶´ç´… */
      background: var(--accent-red); 
      color: white;
      transform: scale(1.1);
    }

    .quantity-input {
      width: 80px;
      text-align: center;
      padding: 10px;
      border: 2px solid var(--border-color);
      border-radius: 10px;
      font-weight: bold;
      font-size: 1.1rem;
    }

    /* Buttons */
    .btn {
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 18px 35px;
      /* æŒ‰éˆ•ä½¿ç”¨è–èª•æ¼¸å±¤ */
      background: var(--christmas-gradient); 
      color: white;
      border: none;
      border-radius: 12px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      justify-content: center;
      min-width: 200px;
    }

    .btn:hover {
      transform: translateY(-3px);
      /* é™°å½±é¡è‰²ä½¿ç”¨é»ç¶´ç´… */
      box-shadow: 0 10px 25px rgba(168, 14, 47, 0.3); 
    }

    .btn:active {
      transform: translateY(-1px);
    }

    /* Total Section */
    .total-section {
      /* ç¸½è¨ˆå€å¡Šä½¿ç”¨è–èª•æ¼¸å±¤ */
      background: var(--christmas-gradient); 
      color: white;
      text-align: center;
      padding: 30px;
      border-radius: 20px;
      margin: 30px 0;
    }

    .total-amount {
      font-size: 2.5rem;
      font-weight: bold;
      margin: 20px 0;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    }

    /* Hidden Elements */
    .hidden {
      display: none;
    }

    .slide-down {
      animation: slideDown 0.3s ease-out;
    }

    @keyframes slideDown {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    /* Thank You Page */
    .thank-you {
      text-align: center;
      padding: 60px 40px;
      background: white;
      border-radius: 20px;
      box-shadow: var(--shadow);
      margin: 40px 0;
    }

    .thank-you h2 {
      /* æ¨™é¡Œé¡è‰²ä½¿ç”¨é»ç¶´ç´… */
      color: var(--accent-red); 
      font-size: 2.5rem;
      margin-bottom: 30px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 15px;
    }

    .order-summary {
      /* èƒŒæ™¯ä½¿ç”¨é›ªç™½ */
      background: var(--snow-white); 
      border-radius: 15px;
      padding: 30px;
      margin: 30px 0;
      text-align: left;
    }

    .summary-table {
      width: 100%;
      border-collapse: collapse;
      margin: 20px 0;
      background: white;
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .summary-table th,
    .summary-table td {
      padding: 15px 20px;
      text-align: left;
      border-bottom: 1px solid var(--border-color);
    }

    .summary-table th {
      /* è¡¨æ ¼é ­éƒ¨ä½¿ç”¨è–èª•æ¼¸å±¤ */
      background: var(--christmas-gradient); 
      color: white;
      font-weight: 600;
    }

    .summary-table tr:hover {
      /* Hover èƒŒæ™¯ä½¿ç”¨é›ªç™½ */
      background: var(--snow-white); 
    }

    /* Iframe Container */
    .iframe-container {
      position: relative;
      width: 100%;
      aspect-ratio: 16/9;
      margin: 25px 0;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: var(--shadow);
    }

    .iframe-container iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    /* ğŸ“Œ æ–°å¢ï¼šåœ–ç‰‡å®¹å™¨æ¨£å¼ (ç”¨æ–¼æ›¿æ› iframe) */
    .image-container {
      position: relative;
      width: 100%;
      margin: 25px 0;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: var(--shadow);
      /* ç¢ºä¿åœ–ç‰‡åœ¨å®¹å™¨å…§æ­£å¸¸é¡¯ç¤º */
    }
    
    .image-container img {
      width: 100%;
      height: auto;
      display: block;
    }

    /* Mobile Responsive (ä¿æŒä¸è®Š) */
    @media (max-width: 768px) {
      .container {
        padding: 0 15px;
      }

      .header {
        padding: 40px 0;
      }

      .header h1 {
        font-size: 2rem;
      }

      .section {
        margin: 20px 0;
        padding: 25px 20px;
        border-radius: 15px;
      }

      .section h2 {
        font-size: 1.5rem;
      }

      .info-grid {
        grid-template-columns: 1fr;
        gap: 15px;
      }

      .product-item {
        flex-direction: column;
        gap: 15px;
        align-items: stretch;
      }

      .product-quantity {
        justify-content: center;
      }

      .radio-group, .checkbox-group {
        gap: 10px;
      }

      .radio-item, .checkbox-item {
        padding: 12px 15px;
      }

      .btn {
        width: 100%;
        padding: 15px 25px;
      }

      .total-amount {
        font-size: 2rem;
      }

      .thank-you {
        padding: 40px 20px;
      }

      .summary-table th,
      .summary-table td {
        padding: 12px 15px;
        font-size: 0.9rem;
      }
    }

    @media (max-width: 480px) {
      .header h1 {
        font-size: 1.7rem;
      }

      .section {
        padding: 20px 15px;
      }

      .form-input {
        padding: 12px 15px;
      }

      .quantity-btn {
        width: 35px;
        height: 35px;
      }

      .quantity-input {
        width: 70px;
        padding: 8px;
      }
    }

    /* Loading Animation (ä¿æŒä¸è®Š) */
    .loading {
      display: inline-block;
      width: 20px;
      height: 20px;
      border: 3px solid rgba(255,255,255,.3);
      border-radius: 50%;
      border-top-color: #fff;
      animation: spin 1s ease-in-out infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    /* Success Animation (ä¿æŒä¸è®Š) */
    .success-icon {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      background: var(--christmas-gradient); /* ä½¿ç”¨è–èª•æ¼¸å±¤ */
      display: flex;
      align-items: center;
      justify-content: center;
      margin: 0 auto 20px;
      animation: successPulse 0.6s ease-out;
    }

    @keyframes successPulse {
      0% { transform: scale(0); }
      50% { transform: scale(1.1); }
      100% { transform: scale(1); }
    }
  </style>
  <script>
    let products = [];
    let backCarFees = {
      "æ¡ƒåœ’ä½³æ¬£èŠ±åº—": 0,
      "ç«¹åŒ—æ¿±æ±Ÿæ—èŠ±åº—": 150,
      "è‹—æ —äº¤æµé“": 150,
      "å°ä¸­èŠ³æ—èŠ±å‰": 150,
      "å°ä¸­æ±ŸåˆèŠ±å¸‚": 200,
      "è±åŸäº¤æµé“": 150,
      "å½°åŒ–ç”°å°¾èŠ±å¸‚": 150,
      "è‰å±¯äº¤æµé“": 200,
      "åŸ”é‡Œé®ä¿¡ç¾©è·¯100è™Ÿ": 200,
      "æ–—å—äº¤æµé“": 200,
      "å˜‰ç¾©äº¤æµé“": 200,
      "æ°´ä¸Šäº¤æµé“": 200,
      "æ–°ç‡Ÿäº¤æµé“": 200,
      "å°å—èŠ±å¸‚": 200,
      "ä»å¾·äº¤æµé“": 200,
      "æ¥ æ¢“äº¤æµé“": 200,
      "é«˜é›„å°šé™¶åŠèŠ±åº—": 200,
      "é«˜é›„èŠ±å¸‚": 200,
      "å±æ±åœ‹èŠ³èŠ±åº—": 200
    };
    let currentFee = 0;

    function loadProducts() {
      // Check if we're in Google Apps Script environment
      if (typeof google !== 'undefined' && google.script) {
        google.script.run.withSuccessHandler(data => {
          products = data;
          renderProducts();
        }).getProducts();
      } else {
        // Mock data for preview/testing (è«¾è²æ¾ç›¸é—œå•†å“)
        products = [
          ['ç¾åœ‹é€²å£è«¾è²æ¾ 1.5å°º (45cm)', 950],
          ['ç¾åœ‹é€²å£è«¾è²æ¾ 2å°º (60cm)', 1200],
          ['ç¾åœ‹é€²å£è«¾è²æ¾ 2.5å°º (75cm)', 1500],
          ['ç¾åœ‹é€²å£è«¾è²æ¾ 3å°º (90cm)', 1800],
          ['æ—¥æœ¬é›ªæ¾+æ‰æŸè£é£¾çµ„', 700],
          ['ç¾åœ‹é€²å£è«¾è²æ¾æ¨¹å¹¹ï¼ˆå°å‹ï¼‰', 450],
          ['è–èª•é»ç¶´è£é£¾åŒ… (ç´…)', 250],
          ['è–èª•é»ç¶´è£é£¾åŒ… (é‡‘/éŠ…)', 300],
        ];
        renderProducts();
      }
    }

    function renderProducts() {
      const container = document.getElementById('product-list');
      container.innerHTML = '';
      products.forEach(([name, price], idx) => {
        container.innerHTML += `
          <div class="product-item">
            <div class="product-name">${name} <span class="accent-text">NT$${price}</span></div>
            <div class="product-quantity">
              <button type="button" class="quantity-btn" onclick="changeQuantity(${idx}, -1)">
                <i class="fas fa-minus"></i>
              </button>
              <input type="number" min="0" value="0" class="quantity-input" onchange="calculateTotal()" id="qty-${idx}">
              <button type="button" class="quantity-btn" onclick="changeQuantity(${idx}, 1)">
                <i class="fas fa-plus"></i>
              </button>
            </div>
          </div>`;
      });
    }

    function changeQuantity(index, change) {
      const input = document.getElementById(`qty-${index}`);
      const currentValue = parseInt(input.value) || 0;
      const newValue = Math.max(0, currentValue + change);
      input.value = newValue;
      calculateTotal();
    }

    function calculateTotal() {
      let total = 0;
      products.forEach(([name, price], idx) => {
        const qty = parseInt(document.getElementById('qty-'+idx).value) || 0;
        total += qty * price;
      });

      const delivery = document.querySelector('input[name="delivery"]:checked')?.value || '';
      if (delivery === 'å›é ­è»Š') {
        const place = document.getElementById('backcar-place').value;
        currentFee = backCarFees[place] || 0;
      } else {
        currentFee = 0;
      }

      document.getElementById('total').innerText = (total + currentFee).toLocaleString();

      // âœ… æ–°å¢ï¼šåŒæ­¥æ›´æ–°ã€Œå›é ­è»Šé‹è²»ã€èªªæ˜çš„å°å­—
      const feeText = document.getElementById('backcar-fee');
      if (feeText) {
        feeText.textContent = `NT$${currentFee.toLocaleString()}`;
      }
    }

    function handleDeliveryChange() {
      const value = document.querySelector('input[name="delivery"]:checked').value;
      const deliveryAddress = document.getElementById('delivery-address');
      const backcarOptions = document.getElementById('backcar-options');
      
      deliveryAddress.classList.toggle('hidden', value !== 'å®…é…');
      backcarOptions.classList.toggle('hidden', value !== 'å›é ­è»Š');
      
      if (!deliveryAddress.classList.contains('hidden')) {
        deliveryAddress.classList.add('slide-down');
      }
      if (!backcarOptions.classList.contains('hidden')) {
        backcarOptions.classList.add('slide-down');
      }
      
      // Update radio button styles
      document.querySelectorAll('input[name="delivery"]').forEach(radio => {
        const item = radio.closest('.radio-item');
        if (radio.checked) {
          item.classList.add('checked');
        } else {
          item.classList.remove('checked');
        }
      });
      
      calculateTotal();
    }

    function handleContactChange() {
      document.querySelectorAll('input[name="contact"]').forEach(radio => {
        const item = radio.closest('.radio-item');
        if (radio.checked) {
          item.classList.add('checked');
        } else {
          item.classList.remove('checked');
        }
      });
    }

    function handleAgreeChange() {
      const checkbox = document.getElementById('agree');
      const item = checkbox.closest('.checkbox-item');
      if (checkbox.checked) {
        item.classList.add('checked');
      } else {
        item.classList.remove('checked');
      }
    }

    function submitOrder() {
      const submitBtn = document.querySelector('.submit-btn');
      const originalText = submitBtn.innerHTML;
      submitBtn.innerHTML = '<div class="loading"></div> è™•ç†ä¸­...';
      submitBtn.disabled = true;

      const email = document.getElementById('email').value.trim();
      const agree = document.getElementById('agree').checked;
      const name = document.getElementById('cust-name').value.trim();
      const phone = document.getElementById('cust-phone').value.trim();
      const contactMethod = document.querySelector('input[name="contact"]:checked')?.value || '';
      const contactDetail = document.getElementById('contact-detail').value.trim();
      const date = document.getElementById('pickup-date').value;
      const delivery = document.querySelector('input[name="delivery"]:checked')?.value || '';
      const address = document.getElementById('address').value.trim();
      const backcarPlace = document.getElementById('backcar-place').value;
      const remitLast5 = document.getElementById('remit-last5').value.trim();
      const remitBank = document.getElementById('remit-bank').value.trim();

      if (!email) { 
        alert("è«‹è¼¸å…¥é›»å­éƒµä»¶"); 
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return; 
      }
      if (!agree) { 
        alert("è«‹å…ˆå‹¾é¸åŒæ„è¨‚è³¼é ˆçŸ¥"); 
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return; 
      }
      if (!name) { 
        alert("è«‹è¼¸å…¥å§“å"); 
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return; 
      }
      if (!phone) { 
        alert("è«‹è¼¸å…¥é›»è©±"); 
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return; 
      }
      if (!contactMethod) { 
        alert("è«‹é¸æ“‡è¯çµ¡æ–¹å¼"); 
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return; 
      }
      if (!contactDetail) { 
        alert("è«‹å¡«å¯«è©³ç´°è¯çµ¡è³‡è¨Š"); 
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return; 
      }
      // è«¾è²æ¾é€šå¸¸æ˜¯æŒ‡å®šæ—¥æœŸï¼Œé€™è£¡æ—¥æœŸæ¬„ä½æª¢æŸ¥ä¸è®Š
      if (!date) { 
        alert("è«‹é¸æ“‡é è¨ˆå–è²¨æ—¥"); 
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return; 
      }
      if (!delivery) { 
        alert("è«‹é¸æ“‡é…é€æ–¹å¼"); 
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return; 
      }
      if (delivery === 'å®…é…' && !address) { 
        alert("è«‹å¡«å¯«å®…é…åœ°å€"); 
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return; 
      }
      if (delivery === 'å›é ­è»Š' && !backcarPlace) { 
        alert("è«‹é¸æ“‡å›é ­è»Šåœ°é»"); 
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return; 
      }
      if (!remitLast5) { 
        alert("è«‹è¼¸å…¥åŒ¯æ¬¾å¸³è™Ÿå¾Œäº”ç¢¼"); 
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return; 
      }
      if (!remitBank) { 
        alert("è«‹è¼¸å…¥éŠ€è¡Œä»£ç¢¼"); 
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return; 
      }

      const items = [];
      products.forEach(([nameP, price], idx) => {
        const qty = parseInt(document.getElementById('qty-'+idx).value) || 0;
        if (qty > 0) {
          items.push({ name: nameP, qty: qty, subtotal: qty * price });
        }
      });

      if (items.length === 0) {
        alert("è«‹è‡³å°‘é¸æ“‡ä¸€é …å•†å“");
        submitBtn.innerHTML = originalText;
        submitBtn.disabled = false;
        return;
      }

      const orderData = {
        email, name, phone,
        contactMethod, contactDetail,
        date, delivery, address, backcarPlace,
        remitLast5, remitBank,
        fee: currentFee,
        items
      };

      // Check if we're in Google Apps Script environment
      if (typeof google !== 'undefined' && google.script) {
        google.script.run.withSuccessHandler(() => showThankYou(orderData))
          .withFailureHandler(() => {
            alert('è¨‚å–®æäº¤å¤±æ•—ï¼Œè«‹ç¨å¾Œå†è©¦');
            submitBtn.innerHTML = originalText;
            submitBtn.disabled = false;
          })
          .submitOrder(orderData);
      } else {
        // For preview/testing - simulate success
        setTimeout(() => showThankYou(orderData), 1000);
      }
    }

    function showThankYou(orderData) {
      const totalAmount = orderData.items.reduce((s,i)=>s+i.subtotal,0) + orderData.fee;

      // é¡¯ç¤ºé…é€æ–¹å¼ç´°ç¯€
      let deliveryDetail = orderData.delivery;
      if (orderData.delivery === 'å®…é…') {
        deliveryDetail += `ï¼ˆåœ°å€ï¼š${orderData.address}ï¼‰`;
      } else if (orderData.delivery === 'å›é ­è»Š') {
        deliveryDetail += `ï¼ˆåœ°é»ï¼š${orderData.backcarPlace}ï¼‰`;
      }

      document.body.innerHTML = `
        <div class="container">
          <div class="thank-you">
            <div class="success-icon">
              <i class="fas fa-check" style="font-size: 2rem; color: white;"></i>
            </div>
            <h2><i class="fas fa-star"></i> æ„Ÿè¬æ‚¨çš„é è³¼ï¼</h2>

            <div class="order-summary">
              <h3 style="color: var(--accent-red); margin-bottom: 20px;"><i class="fas fa-user"></i> è¨‚è³¼äººè³‡æ–™</h3>
              <table class="summary-table">
                <tr><td style="font-weight: 600;">é›»å­éƒµä»¶</td><td>${orderData.email}</td></tr>
                <tr><td style="font-weight: 600;">å§“å</td><td>${orderData.name}</td></tr>
                <tr><td style="font-weight: 600;">é›»è©±</td><td>${orderData.phone}</td></tr>
                <tr><td style="font-weight: 600;">è¯çµ¡æ–¹å¼</td><td>${orderData.contactMethod}</td></tr>
                <tr><td style="font-weight: 600;">è¯çµ¡è³‡è¨Š</td><td>${orderData.contactDetail}</td></tr>
                <tr><td style="font-weight: 600;">é…é€æ–¹å¼</td><td>${deliveryDetail}</td></tr>
                <tr><td style="font-weight: 600;">å–è²¨æ—¥</td><td>${orderData.date}</td></tr>
                <tr><td style="font-weight: 600;">åŒ¯æ¬¾å¾Œäº”ç¢¼</td><td>${orderData.remitLast5}</td></tr>
                <tr><td style="font-weight: 600;">éŠ€è¡Œä»£ç¢¼</td><td>${orderData.remitBank}</td></tr>
              </table>
            </div>

            <div class="order-summary">
              <h3 style="color: var(--accent-red); margin-bottom: 20px;"><i class="fas fa-box-open"></i> è¨‚è³¼æ˜ç´°</h3>
              <table class="summary-table">
                <thead>
                  <tr><th>å•†å“</th><th>æ•¸é‡</th><th>å°è¨ˆ</th></tr>
                </thead>
                <tbody>
                  ${orderData.items.map(it => 
                    `<tr><td>${it.name}</td><td>${it.qty}</td><td>NT$ ${it.subtotal.toLocaleString()}</td></tr>`
                  ).join('')}
                  ${
                    orderData.fee > 0
                      ? `<tr style="background: var(--snow-white);">
                          <td colspan="2" style="font-weight: 600; color: var(--accent-red);">é‹è²»ï¼ˆ${orderData.delivery === 'å›é ­è»Š' ? orderData.backcarPlace : 'å®…é…'}ï¼‰</td>
                          <td style="font-weight: 600; color: var(--accent-red);">NT$ ${orderData.fee.toLocaleString()}</td>
                        </tr>`
                      : ''
                  }
                </tbody>
              </table>
            </div>

            <div class="total-section">
              <h3><i class="fas fa-calculator"></i> ç¸½é‡‘é¡</h3>
              <div class="total-amount">NT$ ${totalAmount.toLocaleString()}</div>
              <p style="font-size: 1.2rem; margin-top: 20px;">
                <i class="fas fa-university"></i> åŒ¯æ¬¾å¸³è™Ÿï¼š101(ç‘èˆˆéŠ€è¡Œ)-0127221335660
              </p>
            </div>

            <div style="background: var(--snow-white); padding: 30px; border-radius: 15px; margin-top: 30px; text-align: left; border: 1px solid var(--border-color);">
              <h4 style="color: var(--christmas-green); margin-bottom: 15px; font-size: 1.3rem;">
                <i class="fas fa-info-circle"></i> æ¥ä¸‹ä¾†è«‹å®Œæˆä»¥ä¸‹æ­¥é©Ÿï¼š
              </h4>
              <ol style="padding-left: 20px; line-height: 1.8; font-size: 1.1rem;">
                <li style="margin-bottom: 10px;">è«‹æˆªåœ–æ­¤é é¢ä¿å­˜è¨‚å–®è³‡è¨Š</li>
                <li style="margin-bottom: 10px;">åŒ¯æ¬¾è‡³æŒ‡å®šå¸³æˆ¶</li>
                <li style="margin-bottom: 10px;">å°‡è¨‚å–®æˆªåœ–åŠåŒ¯æ¬¾è­‰æ˜ä¸€èµ·å‚³é€è‡³å®˜æ–¹LINE</li>
              </ol>
              <div style="text-align: center; margin-top: 25px;">
                <a href="https://lin.ee/0fE8Knb" target="_blank" class="btn" style="text-decoration: none;">
                  <i class="fab fa-line"></i> å‰å¾€ç¦ç››åœ’è— LINE å®˜æ–¹å¸³è™Ÿ
                </a>
              </div>
            </div>
          </div>
        </div>
      `;
    }


    window.onload = () => {
      const select = document.getElementById('backcar-place');
      const defaultOpt = document.createElement('option');
      defaultOpt.value = '';
      defaultOpt.text = 'è«‹é¸æ“‡';
      select.appendChild(defaultOpt);

      Object.keys(backCarFees).forEach(place => {
        const opt = document.createElement('option');
        opt.value = place;
        opt.text = place;
        select.appendChild(opt);
      });

      loadProducts();
    };
  </script>
</head>
<body>
  <div class="header">
    <div class="container">
      <div class="header-content">
        <h1><i class="fas fa-tree"></i> 2025 ç¦ç››åœ’è—è–èª•ç¯€è«¾è²æ¾é è³¼è¡¨å–®</h1>
        <div class="subtitle">
          <i class="fas fa-star"></i>
          <span>é™å®šé è³¼ Â· æ–°é®®ç©ºé‹ Â· ç¯€æ…¶ä½ˆç½®é¦–é¸</span>
          <i class="fas fa-star"></i>
        </div>
      </div>
    </div>
  </div>

  <div class="container">
    <div class="section">
      <h2><i class="fas fa-info-circle"></i> è¨‚è³¼é ˆçŸ¥</h2>
      
      <div class="info-grid">
        <div class="info-card">
          <h3><i class="fas fa-exclamation-triangle"></i> è¨‚è³¼é¢¨éšªèªªæ˜</h3>
          <ul>
            <li>è«¾è²æ¾ç‚º<span class="accent-text">é€²å£è‘‰æ</span>ï¼Œé‹è¼¸éç¨‹æœ‰äº›ç„¡æ³•é¿å…çš„æƒ…æ³ï¼Œå¦‚æŠ˜æã€æ‰è‘‰ã€å§¿æ…‹ä¸å‡ï¼Œæœ‰è¦æ±‚è€…ï¼Œå»ºè­°è‡³åº—é‹ªæŒ‘é¸ã€‚</li>
            <li>é è¨ˆ<span class="accent-text">11æœˆä¸­æ—¬æŠµå°</span>ï¼Œä½†å¯èƒ½æœƒé‡åˆ°ç­æ©Ÿå»¶èª¤ï¼Œåˆ°è²¨æ™‚é–“çš†æœ‰é¢¨éšªï¼Œè«‹è‡ªè¡Œè¡¡é‡è¨‚è³¼ï¼Œè‹¥ç„¡æ³•å¦‚æœŸåˆ°è²¨ï¼Œæœƒå†å¦è¡Œé€šçŸ¥ã€‚</li>
            <li>æ­¤æ¬¡é è¨‚å®Œæˆï¼Œ<span class="accent-text">ç„¡æ³•å–æ¶ˆé€€æ¬¾</span>ï¼Œè¨‚è³¼å‰è«‹ç¢ºèªå¥½è¨‚è³¼å…§å®¹ã€‚</li>
            <li>åŸå°åŸè£é€²å£è«¾è²æ¾æ¯ç¶‘ç´„<span class="accent-text">5å…¬æ–¤é‡</span>ï¼Œå…¶ä¸­ NG æ•¸é‡ç´„ä½” 1â€“2 æ”¯å±¬æ­£å¸¸æè€—ç¯„åœã€‚</li>
          </ul>
        </div>

        <div class="info-card">
          <h3><i class="fas fa-money-bill-wave"></i> é è³¼åƒ¹æ ¼åŠé‹è²»èªªæ˜</h3>
          <ul>
            <li>è¨‚è³¼æœ€ä½é‡ï¼šç´„<span class="accent-text">5å…¬æ–¤é‡/æ†</span></li>
            <li>é è³¼åƒ¹ï¼š<span class="accent-text">NT$2,800/ç¶‘</span> (ä¸å«é…é€é‹è²»)ï¼Œé‹è²»å¦è¨ˆã€‚</li>
            <li>é è³¼æˆªæ­¢æ—¥ç‚º <span class="accent-text">2025/10/31</span>ï¼Œæ´»å‹•æˆªæ­¢å¾Œå°‡æ¢å¾©åŸåƒ¹ï¼Œæ•ä¸æä¾›é è³¼å„ªæƒ ã€‚</li>
            <li>é‹è²»è«‹è¦‹ä¸‹æ–¹ <span class="accent-text">é…é€æ–¹å¼</span> é¸æ“‡çµæœã€‚</li>
          </ul>
        </div>

        <div class="info-card">
          <h3><i class="fas fa-credit-card"></i> è¨‚è³¼æµç¨‹åŠåŒ¯æ¬¾è³‡è¨Š</h3>
          <ul>
            <li>è«‹å¡«å¯«æ­¤è¡¨å–®å¾Œï¼Œæˆªåœ–è¨‚è³¼å®Œæˆç•«é¢ï¼ŒåŒ¯æ¬¾è‡³æŒ‡å®šå¸³æˆ¶</li>
            <li>å†è‡³ <a href="https://lin.ee/0fE8Knb" target="_blank" class="accent-text" style="text-decoration: none;">ç¦ç››å®˜æ–¹LINEå¸³è™Ÿï¼ˆè«‹é»æ­¤ï¼‰</a> å›å‚³è¨‚è³¼é é¢åŠåŒ¯æ¬¾è­‰æ˜æˆªåœ–</li>
            <li><span class="accent-text">åŒ¯æ¬¾è³‡è¨Šï¼š</span><br>
              éŠ€è¡Œï½œï¼ˆ101ï¼‰ç‘èˆˆéŠ€è¡Œ<br>
              å¸³è™Ÿï½œ0127221335660</li>
          </ul>
        </div>

        <div class="info-card">
          <h3><i class="fas fa-calendar-alt"></i> é‡è¦æé†’</h3>
          <ul>
            <li>å¦‚æœ‰å•é¡Œï¼Œè«‹ç§è¨Š <a href="https://lin.ee/0fE8Knb" target="_blank" class="accent-text" style="text-decoration: none;">ç¦ç››å®˜æ–¹LINEå¸³è™Ÿ</a>ã€‚</li>
            <li>è«‹å‹™å¿…ç¢ºèªæ‰€æœ‰è³‡è¨Šå¡«å¯«æ­£ç¢ºï¼Œç‰¹åˆ¥æ˜¯å–è²¨æ—¥åŠé…é€æ–¹å¼ã€‚</li>
            <li><span class="accent-text">è«‹æ³¨æ„ï¼š</span>ç”±æ–¼å­£ç¯€é™å®šå•†å“ï¼Œè«‹å„˜æ—©é è³¼ã€‚</li>
          </ul>
        </div>
      </div>
    </div>

    <div class="section">
      <h2><i class="fas fa-user"></i> è¨‚è³¼äººè³‡æ–™</h2>
      
      <div class="form-group">
        <label for="email"><i class="fas fa-envelope"></i> é›»å­éƒµä»¶</label>
        <input type="email" id="email" class="form-input" placeholder="è«‹è¼¸å…¥æ‚¨çš„é›»å­éƒµä»¶">
      </div>

      <div class="checkbox-group">
        <div class="checkbox-item">
          <input type="checkbox" id="agree" onchange="handleAgreeChange()">
          <label for="agree" style="margin: 0; cursor: pointer;">
            <i class="fas fa-check-circle"></i> æ˜¯ï¼Œæˆ‘å·²é–±è®€æ¸…æ¥šè¨‚è³¼é ˆçŸ¥
          </label>
        </div>
      </div>

      <div class="form-group">
        <label for="cust-name"><i class="fas fa-user"></i> å§“å</label>
        <input type="text" id="cust-name" class="form-input" placeholder="è«‹è¼¸å…¥æ‚¨çš„å§“å">
      </div>

      <div class="form-group">
        <label for="cust-phone"><i class="fas fa-phone"></i> é›»è©±</label>
        <input type="text" id="cust-phone" class="form-input" placeholder="è«‹è¼¸å…¥æ‚¨çš„é›»è©±è™Ÿç¢¼">
      </div>

      <div class="form-group">
        <label><i class="fas fa-comments"></i> è¯çµ¡æ–¹å¼</label>
        <div class="radio-group">
          <div class="radio-item">
            <input type="radio" name="contact" value="Facebook" id="contact-fb" onchange="handleContactChange()">
            <label for="contact-fb" style="margin: 0; cursor: pointer;">
              <i class="fab fa-facebook"></i> Facebook
            </label>
          </div>
          <div class="radio-item">
            <input type="radio" name="contact" value="Instagram" id="contact-ig" onchange="handleContactChange()">
            <label for="contact-ig" style="margin: 0; cursor: pointer;">
              <i class="fab fa-instagram"></i> Instagram
            </label>
          </div>
          <div class="radio-item">
            <input type="radio" name="contact" value="LINE" id="contact-line" onchange="handleContactChange()">
            <label for="contact-line" style="margin: 0; cursor: pointer;">
              <i class="fab fa-line"></i> LINE
            </label>
          </div>
        </div>
      </div>

      <div class="form-group">
        <label for="contact-detail"><i class="fas fa-address-card"></i> è©³ç´°è¯çµ¡è³‡è¨Š</label>
        <input type="text" id="contact-detail" class="form-input" placeholder="è«‹å¡«å¯«æ‚¨çš„è¯çµ¡å¸³è™Ÿæˆ–ID">
      </div>

      <div class="form-group">
        <label for="pickup-date"><i class="fas fa-calendar"></i> é è¨ˆå–è²¨æ—¥</label>
        <input type="date" id="pickup-date" class="form-input">
        <small style="color: var(--text-light); margin-top: 8px; display: block;">
          <i class="fas fa-info-circle"></i> è«¾è²æ¾é è¨ˆ <span class="accent-text">11 æœˆä¸­æ—¬</span> æŠµé”å°ç£
        </small>
      </div>
    </div>

    <div class="section">
      <h2><i class="fas fa-tree"></i> ç”¢å“é¸æ“‡</h2>
      <div class="image-container">
        <img src="https://i.meee.com.tw/gFulufr.jpg" alt="è«¾è²æ¾ç”¢å“ç¤ºæ„åœ–">
      </div>
      <div id="product-list" class="product-list"></div>
    </div>
    <div class="section">
      <h2><i class="fas fa-truck"></i> é…é€æ–¹å¼</h2>
      <div class="radio-group">
        <div class="radio-item">
          <input type="radio" name="delivery" value="å°åŒ—èŠ±å¸‚" id="delivery-taipei" onchange="handleDeliveryChange()">
          <label for="delivery-taipei" style="margin: 0; cursor: pointer;">
            <i class="fas fa-map-marker-alt"></i> å°åŒ—èŠ±å¸‚ (è‡ªå–) - <span class="accent-text">å…é‹è²»</span>
          </label>
        </div>
        <div class="radio-item">
          <input type="radio" name="delivery" value="å®…é…" id="delivery-home" onchange="handleDeliveryChange()">
          <label for="delivery-home" style="margin: 0; cursor: pointer;">
            <i class="fas fa-home"></i> å®…é… (é‹è²»å¦è¨ˆ) - é‹è²»ï¼š<span class="accent-text">NT$0</span> (éœ€å¾…å®¢æœç¢ºèªå ±åƒ¹)
          </label>
        </div>
        <div class="radio-item">
          <input type="radio" name="delivery" value="å›é ­è»Š" id="delivery-backcar" onchange="handleDeliveryChange()">
          <label for="delivery-backcar" style="margin: 0; cursor: pointer;">
            <i class="fas fa-route"></i> å›é ­è»Šé…é€ (é™æŒ‡å®šåœ°é»)
          </label>
        </div>
      </div>

      <div id="delivery-address" class="form-group hidden" style="margin-top: 25px;">
        <label for="address"><i class="fas fa-map-marked-alt"></i> å®…é…åœ°å€</label>
        <textarea id="address" class="form-input" rows="3" placeholder="è«‹è¼¸å…¥è©³ç´°å®…é…åœ°å€"></textarea>
      </div>

      <div id="backcar-options" class="form-group hidden" style="margin-top: 25px;">
        <label for="backcar-place"><i class="fas fa-handshake"></i> å›é ­è»ŠæŒ‡å®šåœ°é»</label>
        <select id="backcar-place" class="form-input" onchange="calculateTotal()"></select>
        <small style="color: var(--text-light); margin-top: 8px; display: block;">
          <i class="fas fa-info-circle"></i> é‹è²»ï¼š<span id="backcar-fee" class="accent-text">NT$0</span> (å°‡æ ¹æ“šé¸æ“‡åœ°é»è‡ªå‹•è¨ˆç®—ï¼Œè«‹é¸æ“‡åœ°é»)
        </small>
      </div>

      <div class="form-group" style="margin-top: 35px;">
        <label for="remit-last5"><i class="fas fa-money-check-alt"></i> åŒ¯æ¬¾å¸³è™Ÿå¾Œäº”ç¢¼</label>
        <input type="text" id="remit-last5" class="form-input" placeholder="è«‹è¼¸å…¥åŒ¯æ¬¾å¸³è™Ÿå¾Œäº”ç¢¼">
      </div>

      <div class="form-group">
        <label for="remit-bank"><i class="fas fa-university"></i> éŠ€è¡Œä»£ç¢¼</label>
        <input type="text" id="remit-bank" class="form-input" placeholder="è«‹è¼¸å…¥åŒ¯æ¬¾éŠ€è¡Œä»£ç¢¼ (ä¾‹: 101)">
      </div>
    </div>

    <div class="total-section">
      <h3><i class="fas fa-calculator"></i> è¨‚å–®ç¸½é‡‘é¡ (å«é‹è²»)</h3>
      <div class="total-amount">NT$ <span id="total">0</span></div>
    </div>

    <div style="text-align: center; margin: 40px 0;">
      <button type="button" class="btn submit-btn" onclick="submitOrder()">
        <i class="fas fa-paper-plane"></i> ç«‹å³é€å‡ºé è³¼å–®
      </button>
    </div>

    <div style="text-align: center; padding: 30px 0; color: var(--text-light); font-size: 0.9rem;">
      <p>&copy; 2025 ç¦ç››åœ’è—. All Rights Reserved.</p>
    </div>

  </div>
</body>
</html>
